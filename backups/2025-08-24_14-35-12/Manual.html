<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¤– Manual WhatsApp Voice Agent V2 Enhanced</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: white;
            margin-top: 20px;
            margin-bottom: 20px;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border-radius: 15px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .step-card {
            background: #f8f9fa;
            padding: 25px;
            margin: 20px 0;
            border-radius: 10px;
            border-left: 5px solid #4CAF50;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .step-number {
            display: inline-block;
            width: 40px;
            height: 40px;
            background: #4CAF50;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 40px;
            font-weight: bold;
            margin-right: 15px;
            font-size: 1.2em;
        }

        .step-title {
            font-size: 1.4em;
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
            position: relative;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #3498db;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        .copy-btn:hover {
            background: #2980b9;
        }

        .qr-section {
            background: #e8f5e8;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin: 30px 0;
            border: 2px dashed #4CAF50;
        }

        .qr-code {
            margin: 20px auto;
            padding: 15px;
            background: white;
            border-radius: 10px;
            display: inline-block;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .network-info {
            background: #fff3cd;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #ffc107;
            margin: 20px 0;
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-green { background: #28a745; }
        .status-yellow { background: #ffc107; }
        .status-red { background: #dc3545; }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .feature-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
        }

        .feature-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }

        .troubleshoot {
            background: #f8d7da;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #dc3545;
            margin: 20px 0;
        }

        .btn {
            display: inline-block;
            padding: 12px 24px;
            background: #4CAF50;
            color: white;
            text-decoration: none;
            border-radius: 25px;
            margin: 10px;
            transition: background 0.3s ease;
        }

        .btn:hover {
            background: #45a049;
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            margin: 15px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            transition: width 0.3s ease;
        }

        .ip-input {
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            margin: 10px;
            width: 200px;
        }

        .ip-detect-btn {
            background: #17a2b8;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
        }

        .footer {
            text-align: center;
            padding: 30px;
            background: #2c3e50;
            color: white;
            border-radius: 15px;
            margin-top: 40px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
                margin: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .feature-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>ğŸ¤– Manual WhatsApp Voice Agent V2 Enhanced</h1>
            <p>Guia Completo para Interface com Abas, Coqui TTS e ConfiguraÃ§Ã£o MÃ³vel</p>
            <div>
                <span class="status-indicator status-green"></span> FastAPI Backend Enhanced
                <span class="status-indicator status-green"></span> Coqui TTS PortuguÃªs
                <span class="status-indicator status-green"></span> Interface com Abas
                <span class="status-indicator status-yellow"></span> WhatsApp Business API
            </div>
        </div>

        <!-- Quick Start Guide -->
        <div class="step-card">
            <div class="step-title">
                <span class="step-number">ğŸš€</span>
                <span>InÃ­cio RÃ¡pido - VERSÃƒO ENHANCED com Port Cleanup (3 Minutos)</span>
            </div>
            <p><strong>Use o script automatizado Enhanced com limpeza de portas:</strong></p>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copiar</button>
start_enhanced_correct.bat
            </div>
            <p><strong>Ou manualmente com servidor Enhanced:</strong></p>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copiar</button>
cd backend
python main_enhanced.py
            </div>
            <p>Depois acesse: <a href="http://localhost:8001" target="_blank">http://localhost:8001</a></p>
            
            <div class="network-info">
                <h4>âš¡ Novos Recursos Enhanced 2025:</h4>
                <ul>
                    <li>ğŸ§¹ <strong>Port Cleanup AutomÃ¡tico:</strong> Sistema mata processos nas portas 8001/8002 automaticamente</li>
                    <li>ğŸ“Š <strong>Interface com Abas:</strong> Chat, LLM Config, TTS & Voice, Database, WhatsApp, Monitoring</li>
                    <li>ğŸ”Š <strong>Coqui TTS Expandido:</strong> 6 modelos portugueses incluindo VITS, YourTTS, Tacotron2 e Bark</li>
                    <li>ğŸ­ <strong>Clonagem de Voz AvanÃ§ada:</strong> Upload WAV/MP3/FLAC, validaÃ§Ã£o automÃ¡tica, listar vozes</li>
                    <li>ğŸ’¾ <strong>Banco de Dados IA:</strong> SQLite com consultas em linguagem natural</li>
                    <li>ğŸ” <strong>Monitoramento Real-time:</strong> Status detalhado de todos os serviÃ§os</li>
                    <li>âš™ï¸ <strong>Stop Button Fix:</strong> BotÃ£o parar funciona corretamente sem travamentos</li>
                    <li>ğŸ¤ <strong>STT Visual:</strong> ConfirmaÃ§Ã£o visual da transcriÃ§Ã£o no chat</li>
                </ul>
            </div>
        </div>

        <!-- Step-by-Step Guide -->
        <div class="step-card">
            <div class="step-title">
                <span class="step-number">1</span>
                <span>Configurar Ambiente Virtual (Recomendado)</span>
            </div>
            <p>O ambiente virtual garante que as dependÃªncias funcionem corretamente:</p>
            
            <h4>MÃ©todo 1: Script Automatizado</h4>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copiar</button>
start_venv.bat
            </div>
            
            <h4>MÃ©todo 2: Manual</h4>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copiar</button>
python -m venv venv
venv\Scripts\activate
pip install -r requirements.txt
            </div>
            
            <div class="network-info">
                <h4>âš¡ Por que usar ambiente virtual?</h4>
                <ul>
                    <li>ğŸ”’ <strong>Isola dependÃªncias:</strong> Evita conflitos com outros projetos</li>
                    <li>ğŸ› <strong>Corrige erros de STT:</strong> Garante versÃµes corretas do librosa/soundfile</li>
                    <li>ğŸ› ï¸ <strong>Facilita manutenÃ§Ã£o:</strong> Ambiente limpo e controlado</li>
                </ul>
            </div>
        </div>

        <div class="step-card">
            <div class="step-title">
                <span class="step-number">2</span>
                <span>Instalar DependÃªncias Enhanced</span>
            </div>
            <p>Primeiro, verifique se o Python estÃ¡ instalado:</p>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copiar</button>
python --version
            </div>
            <p>VersÃ£o mÃ­nima: <strong>Python 3.9+</strong> (recomendado para Coqui TTS)</p>
            
            <h4>Instalar DependÃªncias Enhanced (recomendado):</h4>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copiar</button>
pip install -r requirements_enhanced.txt
            </div>
            
            <div class="network-info">
                <h4>ğŸ”Š Coqui TTS - DependÃªncias Especiais:</h4>
                <ul>
                    <li>ğŸ’» <strong>PyTorch:</strong> Para processamento neural de voz</li>
                    <li>ğŸ‡µğŸ‡¹ <strong>Modelos PortuguÃªs:</strong> VITS, YourTTS multilingual</li>
                    <li>ğŸ­ <strong>Clonagem de Voz:</strong> Suporte para vozes personalizadas</li>
                    <li>âš¡ <strong>GPU (opcional):</strong> AceleraÃ§Ã£o com CUDA se disponÃ­vel</li>
                </ul>
                <p><strong>InstalaÃ§Ã£o manual do Coqui TTS:</strong></p>
                <div class="code-block">
pip install TTS torch torchaudio
                </div>
            </div>
        </div>

        <div class="step-card">
            <div class="step-title">
                <span class="step-number">3</span>
                <span>Navegar para o DiretÃ³rio</span>
            </div>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copiar</button>
cd F:\Projetos2025BKP\Whisper_Whats_Agent_V2
            </div>
        </div>

        <div class="step-card">
            <div class="step-title">
                <span class="step-number">4</span>
                <span>Iniciar o Servidor Enhanced com Port Cleanup</span>
            </div>
            
            <h4>ğŸš€ MÃ©todo 1: Script Automatizado (Recomendado)</h4>
            <p>Use o script que <strong>limpa portas automaticamente</strong> e inicia o servidor:</p>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copiar</button>
start_enhanced_correct.bat
            </div>
            
            <h4>ğŸ› ï¸ MÃ©todo 2: Manual com Virtual Environment</h4>
            <p>Inicie o servidor Enhanced <strong>com ambiente virtual ativado</strong>:</p>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copiar</button>
venv\Scripts\activate
cd backend
python main_enhanced.py
            </div>
            
            <h4>ğŸ§¹ MÃ©todo 3: Cleanup Manual de Portas</h4>
            <p>Se tiver conflitos de porta, execute primeiro:</p>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copiar</button>
cleanup_ports.bat
            </div>
            
            <div class="network-info">
                <h4>ğŸ§¹ Novo Sistema de Port Cleanup AutomÃ¡tico:</h4>
                <ul>
                    <li>ğŸ” <strong>Verifica portas 8001/8002:</strong> Detecta processos usando as portas</li>
                    <li>ğŸ›‘ <strong>Termina processos:</strong> Mata automaticamente PIDs conflitantes</li>
                    <li>ğŸ <strong>Cleanup Python:</strong> Remove servidores Python residuais</li>
                    <li>âœ… <strong>VerificaÃ§Ã£o final:</strong> Confirma se portas estÃ£o livres</li>
                    <li>âš¡ <strong>InicializaÃ§Ã£o limpa:</strong> Garante startup sem conflitos</li>
                </ul>
                
                <h4>âš¡ Aguarde o Carregamento Enhanced:</h4>
                <ul>
                    <li>ğŸ§¹ <strong>Port cleanup completed...</strong> (limpeza automÃ¡tica)</li>
                    <li>ğŸ”„ <strong>Loading Whisper models...</strong> (primeira vez pode demorar)</li>
                    <li>ğŸ”Š <strong>Loading Coqui TTS...</strong> (download de 6 modelos portugueses)</li>
                    <li>ğŸ­ <strong>Voice cloning ready...</strong> (sistema de clonagem ativo)</li>
                    <li>ğŸ’¾ <strong>Database initialized...</strong> (SQLite com IA)</li>
                    <li>âœ… <strong>Enhanced services initialized</strong></li>
                    <li>ğŸŒ <strong>Server running on http://0.0.0.0:8001</strong></li>
                    <li>ğŸ“Š <strong>Enhanced interface with 6 tabs available</strong></li>
                </ul>
                
                <h4>ğŸ“Š Portas dos ServiÃ§os Enhanced:</h4>
                <ul>
                    <li><strong>8001:</strong> Interface Enhanced com 6 abas (Chat, LLM, TTS, DB, WhatsApp, Monitor)</li>
                    <li><strong>8001/docs:</strong> DocumentaÃ§Ã£o completa da API FastAPI</li>
                    <li><strong>8001/health:</strong> Status detalhado de todos os serviÃ§os</li>
                    <li><strong>8001/api/tts/models:</strong> Lista dos 6 modelos Coqui TTS portugueses</li>
                    <li><strong>8001/api/tts/list-cloned-voices:</strong> Gerenciamento de vozes clonadas</li>
                </ul>
                
                <h4>ğŸ”§ UtilitÃ¡rios Inclusos:</h4>
                <ul>
                    <li><strong>start_enhanced_correct.bat:</strong> Startup completo com port cleanup</li>
                    <li><strong>cleanup_ports.bat:</strong> Limpeza manual de portas</li>
                    <li><strong>start_venv.bat:</strong> CriaÃ§Ã£o/ativaÃ§Ã£o do ambiente virtual</li>
                </ul>
            </div>
        </div>

        <div class="step-card">
            <div class="step-title">
                <span class="step-number">5</span>
                <span>Verificar Status do Sistema</span>
            </div>
            <p>Teste se tudo estÃ¡ funcionando:</p>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copiar</button>
curl http://localhost:8001/health
            </div>
            
            <p><strong>Resposta esperada:</strong></p>
            <div class="code-block">
{"status":"healthy","whisper_loaded":true,"version":"2.0.1-fixed"}
            </div>
        </div>

        <!-- Network Configuration -->
        <div class="qr-section">
            <h2>ğŸ“± ConfiguraÃ§Ã£o para Celular</h2>
            <p>Para acessar pelo celular, conecte-se na <strong>mesma rede WiFi</strong></p>
            
            <div style="margin: 20px 0;">
                <label>Digite o IP do seu computador:</label><br>
                <input type="text" id="ipInput" class="ip-input" placeholder="ex: 192.168.1.100" value="192.168.1.100">
                <button class="ip-detect-btn" onclick="detectIP()">ğŸ” Detectar IP</button>
                <button class="ip-detect-btn" onclick="generateQR()">ğŸ“± Gerar QR Code</button>
            </div>

            <div id="currentIP" style="margin: 15px 0; font-weight: bold;"></div>
            
            <div id="qrcode" class="qr-code" style="display: none;"></div>
            
            <div id="mobileLinks" style="display: none;">
                <h3>ğŸ”— Links para Celular:</h3>
                <div style="margin: 10px 0;">
                    <strong>Interface Principal:</strong><br>
                    <span id="mainLink" style="color: #2980b9; font-family: monospace;"></span>
                </div>
                <div style="margin: 10px 0;">
                    <strong>Health Check:</strong><br>
                    <span id="healthLink" style="color: #2980b9; font-family: monospace;"></span>
                </div>
            </div>
        </div>

        <!-- Features Overview -->
        <div class="feature-grid">
            <div class="feature-card">
                <div class="feature-icon">ğŸ¤</div>
                <h3>Whisper STT Enhanced</h3>
                <p>Faster-Whisper + OpenAI Whisper para transcriÃ§Ã£o em portuguÃªs com suporte WebM</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ğŸ”Š</div>
                <h3>Coqui TTS PortuguÃªs</h3>
                <p>SÃ­ntese de voz neural em portuguÃªs brasileiro de alta qualidade</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ğŸ“Š</div>
                <h3>Interface com Abas</h3>
                <p>NavegaÃ§Ã£o organizada: Chat, LLM, TTS, Database, WhatsApp, Monitoring</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ğŸ§ </div>
                <h3>Multi-LLM</h3>
                <p>OpenRouter, Google Gemini e modelos locais com switching dinÃ¢mico</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ğŸ’¾</div>
                <h3>Database com IA</h3>
                <p>SQLite integrado com consultas em linguagem natural</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ğŸ­</div>
                <h3>Clonagem de Voz</h3>
                <p>Crie vozes personalizadas com amostras de Ã¡udio de referÃªncia</p>
            </div>
        </div>

        <!-- Enhanced Interface Guide -->
        <div class="step-card">
            <div class="step-title">
                <span class="step-number">ğŸ“Š</span>
                <span>Interface Enhanced com Abas</span>
            </div>
            
            <h4>ğŸ“± NavegaÃ§Ã£o por Abas:</h4>
            <div class="feature-grid">
                <div class="feature-card">
                    <div class="feature-icon">ğŸ’¬</div>
                    <h3>Chat</h3>
                    <p>â€¢ BotÃ£o de gravaÃ§Ã£o de voz ğŸ¤<br>
                    â€¢ BotÃ£o de parar gravaÃ§Ã£o â¹ï¸<br>
                    â€¢ Switch TTS/Texto ğŸ”Š<br>
                    â€¢ Chat em tempo real</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">ğŸ§ </div>
                    <h3>LLM Config</h3>
                    <p>â€¢ OpenRouter, Gemini<br>
                    â€¢ SeleÃ§Ã£o de modelos<br>
                    â€¢ Prompts personalizados<br>
                    â€¢ Controle de criatividade</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">ğŸ”Š</div>
                    <h3>TTS & Voice</h3>
                    <p>â€¢ Coqui TTS PortuguÃªs ğŸ‡µğŸ‡¹<br>
                    â€¢ Teste de voz ğŸ§<br>
                    â€¢ Download de Ã¡udio ğŸ’¾<br>
                    â€¢ Clonagem de voz ğŸ­</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">ğŸ’¾</div>
                    <h3>Database</h3>
                    <p>â€¢ SQLite integrado<br>
                    â€¢ Consultas com IA<br>
                    â€¢ EstatÃ­sticas em tempo real<br>
                    â€¢ HistÃ³rico de conversas</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">ğŸ“±</div>
                    <h3>WhatsApp</h3>
                    <p>â€¢ Business Token<br>
                    â€¢ Phone Number ID<br>
                    â€¢ QR Code setup<br>
                    â€¢ Teste de conexÃ£o</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">ğŸ“Š</div>
                    <h3>Monitoring</h3>
                    <p>â€¢ Status dos serviÃ§os<br>
                    â€¢ Links Ãºteis<br>
                    â€¢ Health checks<br>
                    â€¢ Performance</p>
                </div>
            </div>
            
            <div class="network-info">
                <h4>ğŸ”Š Como Usar o TTS Enhanced:</h4>
                <ol>
                    <li><strong>Aba TTS & Voice:</strong> Acesse as configuraÃ§Ãµes de voz</li>
                    <li><strong>Modelo Coqui:</strong> Selecione "VITS - Portuguese (CV)"</li>
                    <li><strong>Teste de Voz:</strong> Digite texto e clique "Reproduzir Voz"</li>
                    <li><strong>Download:</strong> Baixe o Ã¡udio gerado para teste</li>
                    <li><strong>Clonagem:</strong> FaÃ§a upload de amostra de voz (.wav) e treine</li>
                </ol>
            </div>
        </div>

        <!-- Testing Guide -->
        <div class="step-card">
            <div class="step-title">
                <span class="step-number">6</span>
                <span>Testar a Interface</span>
            </div>
            
            <h4>No Computador:</h4>
            <a href="http://localhost:8001" target="_blank" class="btn">ğŸ–¥ï¸ Abrir Interface</a>
            <a href="http://localhost:8001/docs" target="_blank" class="btn btn-secondary">ğŸ“– API Docs</a>
            
            <h4>Testes a Realizar:</h4>
            <ul>
                <li>ğŸ¤ <strong>GravaÃ§Ã£o de Voz:</strong> Clique no microfone e permita acesso</li>
                <li>ğŸ’¬ <strong>Chat de Texto:</strong> Digite mensagens na caixa</li>
                <li>ğŸ”Œ <strong>WebSocket:</strong> Verifique status "Conectado"</li>
                <li>ğŸ“± <strong>Celular:</strong> Acesse via QR code na mesma WiFi</li>
            </ul>
        </div>

        <!-- Troubleshooting -->
        <div class="troubleshoot">
            <h3>ğŸ”§ SoluÃ§Ã£o de Problemas</h3>
            
            <h4>âŒ Erro: "Port already in use" / "Porta jÃ¡ em uso"</h4>
            <ul>
                <li><strong>SoluÃ§Ã£o AutomÃ¡tica:</strong> Use <code>start_enhanced_correct.bat</code> (jÃ¡ inclui cleanup)</li>
                <li><strong>SoluÃ§Ã£o Manual:</strong> Execute <code>cleanup_ports.bat</code> antes de iniciar</li>
                <li><strong>VerificaÃ§Ã£o:</strong> <code>netstat -ano | findstr ":8001"</code> para ver processos ativos</li>
                <li><strong>Kill Manual:</strong> <code>taskkill /f /pid [PID_NUMBER]</code> para terminar processo especÃ­fico</li>
            </ul>
            
            <h4>âŒ Erro: "Modelo Whisper nÃ£o carregando"</h4>
            <ul>
                <li>Aguarde o download (primeira execuÃ§Ã£o pode demorar 5-10 minutos)</li>
                <li>Verifique espaÃ§o em disco (modelos Whisper ~150MB + Coqui TTS ~500MB)</li>
                <li>Reinstale: <code>pip install --upgrade openai-whisper faster-whisper</code></li>
                <li>Limpe cache: Apague pasta <code>~/.cache/whisper</code></li>
            </ul>

            <h4>âŒ Erro: "Connection Refused"</h4>
            <ul>
                <li>Verifique se o servidor estÃ¡ rodando (veja logs no terminal)</li>
                <li>Confirme a porta 8001 com <code>netstat -ano | findstr ":8001"</code></li>
                <li>Desative firewall/antivÃ­rus temporariamente</li>
                <li>Teste localhost primeiro: <code>curl http://localhost:8001/health</code></li>
            </ul>

            <h4>âŒ Erro: "Microfone nÃ£o funciona"</h4>
            <ul>
                <li>Permita acesso ao microfone no navegador (clique no Ã­cone de cadeado)</li>
                <li>Use HTTPS em produÃ§Ã£o para acesso externo</li>
                <li>Teste em navegador diferente (Chrome recomendado)</li>
                <li>Verifique se microfone funciona em outras aplicaÃ§Ãµes</li>
            </ul>
            
            <h4>âŒ Erro: "Coqui TTS nÃ£o funciona"</h4>
            <ul>
                <li>Instale manualmente: <code>pip install TTS torch torchaudio</code></li>
                <li>Teste modelo especÃ­fico na aba "TTS & Voice"</li>
                <li>Verifique logs para erros de download de modelos</li>
                <li>Primeira execuÃ§Ã£o baixa modelos automaticamente (~500MB)</li>
            </ul>
            
            <h4>âŒ Erro: "Virtual Environment"</h4>
            <ul>
                <li>Crie manualmente: <code>python -m venv venv</code></li>
                <li>Ative: <code>venv\Scripts\activate</code> (Windows)</li>
                <li>Instale dependÃªncias: <code>pip install -r requirements.txt</code></li>
                <li>Use <code>start_venv.bat</code> para automatizar</li>
            </ul>

            <h4>ğŸ” Verificar Logs e Status:</h4>
            <div class="code-block">
# Terminal onde o servidor estÃ¡ rodando mostra logs em tempo real
# Procure por estas mensagens de sucesso:
# âœ… "Port cleanup completed"
# âœ… "Whisper model loaded successfully"
# âœ… "Coqui TTS initialized"
# âœ… "Enhanced services initialized"
# âœ… "Server running on http://0.0.0.0:8001"

# Health check:
curl http://localhost:8001/health

# Verificar modelos TTS:
curl http://localhost:8001/api/tts/models

# Status dos serviÃ§os:
curl http://localhost:8001/api/status
            </div>
            
            <h4>ğŸ† Dicas de Performance:</h4>
            <ul>
                <li><strong>GPU:</strong> Se tiver NVIDIA, instale CUDA para aceleraÃ§Ã£o</li>
                <li><strong>RAM:</strong> MÃ­nimo 4GB, recomendado 8GB+ para todos os modelos</li>
                <li><strong>Disco:</strong> SSD recomendado para carregamento rÃ¡pido de modelos</li>
                <li><strong>Internet:</strong> Primeira execuÃ§Ã£o requer boa conexÃ£o para downloads</li>
            </ul>
        </div>

        <!-- Mobile Configuration Enhanced -->
        <div class="step-card">
            <div class="step-title">
                <span class="step-number">ğŸ“±</span>
                <span>ConfiguraÃ§Ã£o MÃ³vel Enhanced</span>
            </div>
            
            <h4>ğŸ” Passo a Passo para Celular:</h4>
            <ol>
                <li><strong>Mesma Rede WiFi:</strong> Conecte o celular na mesma rede do computador</li>
                <li><strong>Gerar QR Code:</strong> Use o botÃ£o abaixo para criar QR code de acesso</li>
                <li><strong>Escanear:</strong> Abra a cÃ¢mera do celular e escaneie o QR code</li>
                <li><strong>Testar Interface:</strong> Navegue pelas abas e teste funcionalidades</li>
                <li><strong>PermissÃµes:</strong> Autorize acesso ao microfone quando solicitado</li>
            </ol>
            
            <div class="network-info">
                <h4>ğŸ¤ Testes no Celular:</h4>
                <ul>
                    <li><strong>Aba Chat:</strong> Grave Ã¡udio tocando no microfone ğŸ¤</li>
                    <li><strong>Aba TTS:</strong> Digite texto e reproduza voz em portuguÃªs ğŸ”Š</li>
                    <li><strong>NavegaÃ§Ã£o:</strong> Teste todas as 6 abas da interface</li>
                    <li><strong>Responsividade:</strong> Interface adapta automaticamente ao celular</li>
                </ul>
            </div>
        </div>

        <!-- WhatsApp Integration Enhanced -->
        <div class="step-card">
            <div class="step-title">
                <span class="step-number">7</span>
                <span>IntegraÃ§Ã£o WhatsApp Enhanced</span>
            </div>
            
            <div class="network-info">
                <h4>ğŸ“± WhatsApp Business API Enhanced</h4>
                <p>Configure na <strong>Aba WhatsApp</strong> da interface:</p>
                <ol>
                    <li><strong>Business Token:</strong> Cole seu token do WhatsApp Business</li>
                    <li><strong>Phone Number ID:</strong> Insira o ID do nÃºmero (obtido via QR code)</li>
                    <li><strong>Webhook URL:</strong> <code>http://SEU_IP:8001/api/whatsapp/webhook</code></li>
                    <li><strong>Gerar QR Code:</strong> Use o botÃ£o na interface para configuraÃ§Ã£o</li>
                    <li><strong>Testar ConexÃ£o:</strong> Clique em "Testar ConexÃ£o" para validar</li>
                </ol>
                
                <h4>ğŸ“Š Funcionalidades Integradas:</h4>
                <ul>
                    <li>ğŸ¤ <strong>Voz para WhatsApp:</strong> Transcreve Ã¡udios recebidos</li>
                    <li>ğŸ”Š <strong>Resposta TTS:</strong> Envia Ã¡udio sintetizado em portuguÃªs</li>
                    <li>ğŸ’¾ <strong>HistÃ³rico:</strong> Salva conversas no banco de dados</li>
                    <li>ğŸ§  <strong>IA Integrada:</strong> Respostas via OpenRouter/Gemini</li>
                </ul>
            </div>
        </div>

        <!-- Progress Tracking Enhanced -->
        <div class="step-card">
            <div class="step-title">
                <span class="step-number">ğŸ“Š</span>
                <span>Status do Sistema Enhanced</span>
            </div>
            
            <div>
                <label>Backend FastAPI Enhanced:</label>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 100%;"></div>
                </div>
            </div>
            
            <div>
                <label>Whisper STT (Faster + OpenAI):</label>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 100%;"></div>
                </div>
            </div>
            
            <div>
                <label>Coqui TTS PortuguÃªs:</label>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 100%;"></div>
                </div>
            </div>
            
            <div>
                <label>Interface com Abas:</label>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 100%;"></div>
                </div>
            </div>
            
            <div>
                <label>Multi-LLM (OpenRouter/Gemini):</label>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 100%;"></div>
                </div>
            </div>
            
            <div>
                <label>Database com IA:</label>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 100%;"></div>
                </div>
            </div>
            
            <div>
                <label>Clonagem de Voz:</label>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 85%;"></div>
                </div>
            </div>
            
            <div>
                <label>WhatsApp Business Integration:</label>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 90%;"></div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <h3>ğŸ† Sistema Enhanced Pronto!</h3>
            <p>WhatsApp Voice Agent V2 Enhanced - Interface com Abas + Coqui TTS + Multi-LLM</p>
            <p>ğŸ“Š Recursos: 6 Abas | ğŸ”Š TTS PortuguÃªs | ğŸ§  Multi-LLM | ğŸ’¾ Database IA | ğŸ­ Clonagem Voz</p>
            <p>ğŸ“§ Suporte: Logs no terminal | ğŸ”— Docs: /docs | ğŸ“Š Health: /health | ğŸ“Š API: /api/models</p>
        </div>
    </div>

    <script>
        // Copy code functionality
        function copyCode(button) {
            const codeBlock = button.nextElementSibling || button.parentElement;
            const text = codeBlock.textContent.replace('Copiar', '').trim();
            navigator.clipboard.writeText(text).then(() => {
                button.textContent = 'Copiado!';
                setTimeout(() => {
                    button.textContent = 'Copiar';
                }, 2000);
            });
        }

        // Detect local IP
        function detectIP() {
            // This is a simple method, in a real scenario you might need server-side help
            const ipInput = document.getElementById('ipInput');
            
            // Try to get IP from WebRTC (works in most browsers)
            const RTCPeerConnection = window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection;
            
            if (RTCPeerConnection) {
                const pc = new RTCPeerConnection({iceServers: [{urls: 'stun:stun.l.google.com:19302'}]});
                pc.createDataChannel('');
                pc.createOffer().then(pc.setLocalDescription.bind(pc));
                
                pc.onicecandidate = function(event) {
                    if (event.candidate) {
                        const candidate = event.candidate.candidate;
                        const ip = candidate.match(/(\d+\.\d+\.\d+\.\d+)/);
                        if (ip && ip[1] !== '127.0.0.1') {
                            ipInput.value = ip[1];
                            document.getElementById('currentIP').textContent = `ğŸŒ IP Detectado: ${ip[1]}`;
                            pc.close();
                        }
                    }
                };
            } else {
                alert('DetecÃ§Ã£o automÃ¡tica nÃ£o suportada. Digite o IP manualmente.');
            }
        }

        // Generate QR Code
        function generateQR() {
            const ip = document.getElementById('ipInput').value;
            if (!ip || !ip.match(/^\d+\.\d+\.\d+\.\d+$/)) {
                alert('Por favor, digite um IP vÃ¡lido (ex: 192.168.1.100)');
                return;
            }

            const url = `http://${ip}:8001`;
            
            // Clear previous QR code
            document.getElementById('qrcode').innerHTML = '';
            
            // Generate QR code using qrcode.js
            const qr = qrcode(0, 'M');
            qr.addData(url);
            qr.make();
            
            // Create QR code image
            const qrImage = document.createElement('img');
            qrImage.src = qr.createDataURL(8, 4);
            qrImage.style.maxWidth = '200px';
            qrImage.style.border = '2px solid #4CAF50';
            qrImage.style.borderRadius = '10px';
            
            document.getElementById('qrcode').appendChild(qrImage);
            document.getElementById('qrcode').style.display = 'block';
            
            // Update links
            document.getElementById('mainLink').textContent = url;
            document.getElementById('healthLink').textContent = `${url}/health`;
            document.getElementById('mobileLinks').style.display = 'block';
            
            // Show success message
            const currentIP = document.getElementById('currentIP');
            currentIP.innerHTML = `
                <div style="color: #28a745; font-size: 1.1em;">
                    âœ… QR Code gerado para: <strong>${url}</strong><br>
                    ğŸ“± Escaneie com o celular na mesma WiFi
                </div>
            `;
        }

        // Auto-detect IP on page load
        window.onload = function() {
            detectIP();
        };
    </script>
</body>
</html>