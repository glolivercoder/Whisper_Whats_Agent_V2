<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü§ñ Manual WhatsApp Voice Agent V2 Enhanced</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: white;
            margin-top: 20px;
            margin-bottom: 20px;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border-radius: 15px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .step-card {
            background: #f8f9fa;
            padding: 25px;
            margin: 20px 0;
            border-radius: 10px;
            border-left: 5px solid #4CAF50;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .step-number {
            display: inline-block;
            width: 40px;
            height: 40px;
            background: #4CAF50;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 40px;
            font-weight: bold;
            margin-right: 15px;
            font-size: 1.2em;
        }

        .step-title {
            font-size: 1.4em;
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
            position: relative;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #3498db;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        .copy-btn:hover {
            background: #2980b9;
        }

        .qr-section {
            background: #e8f5e8;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin: 30px 0;
            border: 2px dashed #4CAF50;
        }

        .qr-code {
            margin: 20px auto;
            padding: 15px;
            background: white;
            border-radius: 10px;
            display: inline-block;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .network-info {
            background: #fff3cd;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #ffc107;
            margin: 20px 0;
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-green { background: #28a745; }
        .status-yellow { background: #ffc107; }
        .status-red { background: #dc3545; }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .feature-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
        }

        .feature-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }

        .troubleshoot {
            background: #f8d7da;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #dc3545;
            margin: 20px 0;
        }

        .btn {
            display: inline-block;
            padding: 12px 24px;
            background: #4CAF50;
            color: white;
            text-decoration: none;
            border-radius: 25px;
            margin: 10px;
            transition: background 0.3s ease;
        }

        .btn:hover {
            background: #45a049;
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            margin: 15px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            transition: width 0.3s ease;
        }

        .ip-input {
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            margin: 10px;
            width: 200px;
        }

        .ip-detect-btn {
            background: #17a2b8;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
        }

        .footer {
            text-align: center;
            padding: 30px;
            background: #2c3e50;
            color: white;
            border-radius: 15px;
            margin-top: 40px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
                margin: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .feature-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>ü§ñ Manual WhatsApp Voice Agent V2 Enhanced</h1>
            <p>Guia Completo para Interface com Abas, Coqui TTS e Configura√ß√£o M√≥vel</p>
            <div>
                <span class="status-indicator status-green"></span> FastAPI Backend Enhanced
                <span class="status-indicator status-green"></span> Coqui TTS Portugu√™s
                <span class="status-indicator status-green"></span> Interface com Abas
                <span class="status-indicator status-yellow"></span> WhatsApp Business API
            </div>
        </div>

        <!-- Quick Start Guide -->
        <div class="step-card">
            <div class="step-title">
                <span class="step-number">üöÄ</span>
                <span>In√≠cio R√°pido - VERS√ÉO ENHANCED com Port Cleanup (3 Minutos)</span>
            </div>
            <p><strong>Use o script automatizado Enhanced com limpeza de portas:</strong></p>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copiar</button>
start_enhanced_correct.bat
            </div>
            <p><strong>Ou manualmente com servidor Enhanced:</strong></p>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copiar</button>
cd backend
python main_enhanced.py
            </div>
            <p>Depois acesse: <a href="http://localhost:8001" target="_blank">http://localhost:8001</a></p>
            
            <div class="network-info">
                <h4>‚ö° Novos Recursos Enhanced 2025:</h4>
                <ul>
                    <li>üßπ <strong>Port Cleanup Autom√°tico:</strong> Sistema mata processos nas portas 8001/8002 automaticamente</li>
                    <li>üìä <strong>Interface com Abas:</strong> Chat, LLM Config, TTS & Voice, Database, WhatsApp, Monitoring</li>
                    <li>üîä <strong>Coqui TTS Expandido:</strong> 6 modelos portugueses incluindo VITS, YourTTS, Tacotron2 e Bark</li>
                    <li>üé≠ <strong>Clonagem de Voz Avan√ßada:</strong> Upload WAV/MP3/FLAC, valida√ß√£o autom√°tica, listar vozes</li>
                    <li>üíæ <strong>Banco de Dados IA:</strong> SQLite com consultas em linguagem natural</li>
                    <li>üîç <strong>Monitoramento Real-time:</strong> Status detalhado de todos os servi√ßos</li>
                    <li>‚öôÔ∏è <strong>Stop Button Fix:</strong> Bot√£o parar funciona corretamente sem travamentos</li>
                    <li>üé§ <strong>STT Visual:</strong> Confirma√ß√£o visual da transcri√ß√£o no chat</li>
                </ul>
            </div>
        </div>

        <!-- Step-by-Step Guide -->
        <div class="step-card">
            <div class="step-title">
                <span class="step-number">1</span>
                <span>Configurar Ambiente Virtual (Recomendado)</span>
            </div>
            <p>O ambiente virtual garante que as depend√™ncias funcionem corretamente:</p>
            
            <h4>M√©todo 1: Script Automatizado</h4>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copiar</button>
start_venv.bat
            </div>
            
            <h4>M√©todo 2: Manual</h4>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copiar</button>
python -m venv venv
venv\Scripts\activate
pip install -r requirements.txt
            </div>
            
            <div class="network-info">
                <h4>‚ö° Por que usar ambiente virtual?</h4>
                <ul>
                    <li>üîí <strong>Isola depend√™ncias:</strong> Evita conflitos com outros projetos</li>
                    <li>üêõ <strong>Corrige erros de STT:</strong> Garante vers√µes corretas do librosa/soundfile</li>
                    <li>üõ†Ô∏è <strong>Facilita manuten√ß√£o:</strong> Ambiente limpo e controlado</li>
                </ul>
            </div>
        </div>

        <div class="step-card">
            <div class="step-title">
                <span class="step-number">2</span>
                <span>Instalar Depend√™ncias Enhanced</span>
            </div>
            <p>Primeiro, verifique se o Python est√° instalado:</p>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copiar</button>
python --version
            </div>
            <p>Vers√£o m√≠nima: <strong>Python 3.9+</strong> (recomendado para Coqui TTS)</p>
            
            <h4>Instalar Depend√™ncias Enhanced (recomendado):</h4>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copiar</button>
pip install -r requirements_enhanced.txt
            </div>
            
            <div class="network-info">
                <h4>üîä Coqui TTS - Depend√™ncias Especiais:</h4>
                <ul>
                    <li>üíª <strong>PyTorch:</strong> Para processamento neural de voz</li>
                    <li>üáµüáπ <strong>Modelos Portugu√™s:</strong> VITS, YourTTS multilingual</li>
                    <li>üé≠ <strong>Clonagem de Voz:</strong> Suporte para vozes personalizadas</li>
                    <li>‚ö° <strong>GPU (opcional):</strong> Acelera√ß√£o com CUDA se dispon√≠vel</li>
                </ul>
                <p><strong>Instala√ß√£o manual do Coqui TTS:</strong></p>
                <div class="code-block">
pip install TTS torch torchaudio
                </div>
            </div>
        </div>

        <div class="step-card">
            <div class="step-title">
                <span class="step-number">3</span>
                <span>Navegar para o Diret√≥rio</span>
            </div>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copiar</button>
cd F:\Projetos2025BKP\Whisper_Whats_Agent_V2
            </div>
        </div>

        <div class="step-card">
            <div class="step-title">
                <span class="step-number">4</span>
                <span>Iniciar o Servidor Enhanced com Port Cleanup</span>
            </div>
            
            <h4>üöÄ M√©todo 1: Script Automatizado (Recomendado)</h4>
            <p>Use o script que <strong>limpa portas automaticamente</strong> e inicia o servidor:</p>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copiar</button>
start_enhanced_correct.bat
            </div>
            
            <h4>üõ†Ô∏è M√©todo 2: Manual com Virtual Environment</h4>
            <p>Inicie o servidor Enhanced <strong>com ambiente virtual ativado</strong>:</p>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copiar</button>
venv\Scripts\activate
cd backend
python main_enhanced.py
            </div>
            
            <h4>üßπ M√©todo 3: Cleanup Manual de Portas</h4>
            <p>Se tiver conflitos de porta, execute primeiro:</p>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copiar</button>
cleanup_ports.bat
            </div>
            
            <div class="network-info">
                <h4>üßπ Novo Sistema de Port Cleanup Autom√°tico:</h4>
                <ul>
                    <li>üîç <strong>Verifica portas 8001/8002:</strong> Detecta processos usando as portas</li>
                    <li>üõë <strong>Termina processos:</strong> Mata automaticamente PIDs conflitantes</li>
                    <li>üêç <strong>Cleanup Python:</strong> Remove servidores Python residuais</li>
                    <li>‚úÖ <strong>Verifica√ß√£o final:</strong> Confirma se portas est√£o livres</li>
                    <li>‚ö° <strong>Inicializa√ß√£o limpa:</strong> Garante startup sem conflitos</li>
                </ul>
                
                <h4>‚ö° Aguarde o Carregamento Enhanced:</h4>
                <ul>
                    <li>üßπ <strong>Port cleanup completed...</strong> (limpeza autom√°tica)</li>
                    <li>üîÑ <strong>Loading Whisper models...</strong> (primeira vez pode demorar)</li>
                    <li>üîä <strong>Loading Coqui TTS...</strong> (download de 6 modelos portugueses)</li>
                    <li>üé≠ <strong>Voice cloning ready...</strong> (sistema de clonagem ativo)</li>
                    <li>üíæ <strong>Database initialized...</strong> (SQLite com IA)</li>
                    <li>‚úÖ <strong>Enhanced services initialized</strong></li>
                    <li>üåê <strong>Server running on http://0.0.0.0:8001</strong></li>
                    <li>üìä <strong>Enhanced interface with 6 tabs available</strong></li>
                </ul>
                
                <h4>üìä Portas dos Servi√ßos Enhanced:</h4>
                <ul>
                    <li><strong>8001:</strong> Interface Enhanced com 6 abas (Chat, LLM, TTS, DB, WhatsApp, Monitor)</li>
                    <li><strong>8001/docs:</strong> Documenta√ß√£o completa da API FastAPI</li>
                    <li><strong>8001/health:</strong> Status detalhado de todos os servi√ßos</li>
                    <li><strong>8001/api/tts/models:</strong> Lista dos 6 modelos Coqui TTS portugueses</li>
                    <li><strong>8001/api/tts/list-cloned-voices:</strong> Gerenciamento de vozes clonadas</li>
                </ul>
                
                <h4>üîß Utilit√°rios Inclusos:</h4>
                <ul>
                    <li><strong>start_enhanced_correct.bat:</strong> Startup completo com port cleanup</li>
                    <li><strong>cleanup_ports.bat:</strong> Limpeza manual de portas</li>
                    <li><strong>start_venv.bat:</strong> Cria√ß√£o/ativa√ß√£o do ambiente virtual</li>
                </ul>
            </div>
        </div>

        <div class="step-card">
            <div class="step-title">
                <span class="step-number">5</span>
                <span>Verificar Status do Sistema</span>
            </div>
            <p>Teste se tudo est√° funcionando:</p>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copiar</button>
curl http://localhost:8001/health
            </div>
            
            <p><strong>Resposta esperada:</strong></p>
            <div class="code-block">
{"status":"healthy","whisper_loaded":true,"version":"2.0.1-fixed"}
            </div>
        </div>

        <!-- Network Configuration -->
        <div class="qr-section">
            <h2>üì± Configura√ß√£o para Celular</h2>
            <p>Para acessar pelo celular, conecte-se na <strong>mesma rede WiFi</strong></p>
            
            <div style="margin: 20px 0;">
                <label>Digite o IP do seu computador:</label><br>
                <input type="text" id="ipInput" class="ip-input" placeholder="ex: 192.168.1.100" value="192.168.1.100">
                <button class="ip-detect-btn" onclick="detectIP()">üîç Detectar IP</button>
                <button class="ip-detect-btn" onclick="generateQR()">üì± Gerar QR Code</button>
            </div>

            <div id="currentIP" style="margin: 15px 0; font-weight: bold;"></div>
            
            <div id="qrcode" class="qr-code" style="display: none;"></div>
            
            <div id="mobileLinks" style="display: none;">
                <h3>üîó Links para Celular:</h3>
                <div style="margin: 10px 0;">
                    <strong>Interface Principal:</strong><br>
                    <span id="mainLink" style="color: #2980b9; font-family: monospace;"></span>
                </div>
                <div style="margin: 10px 0;">
                    <strong>Health Check:</strong><br>
                    <span id="healthLink" style="color: #2980b9; font-family: monospace;"></span>
                </div>
            </div>
        </div>

        <!-- Features Overview -->
        <div class="feature-grid">
            <div class="feature-card">
                <div class="feature-icon">üé§</div>
                <h3>Whisper STT Enhanced</h3>
                <p>Faster-Whisper + OpenAI Whisper para transcri√ß√£o em portugu√™s com suporte WebM</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üîä</div>
                <h3>Coqui TTS Portugu√™s</h3>
                <p>S√≠ntese de voz neural em portugu√™s brasileiro de alta qualidade</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üìä</div>
                <h3>Interface com Abas</h3>
                <p>Navega√ß√£o organizada: Chat, LLM, TTS, Database, WhatsApp, Monitoring</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üß†</div>
                <h3>Multi-LLM</h3>
                <p>OpenRouter, Google Gemini e modelos locais com switching din√¢mico</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üíæ</div>
                <h3>Database com IA</h3>
                <p>SQLite integrado com consultas em linguagem natural</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üé≠</div>
                <h3>Clonagem de Voz</h3>
                <p>Crie vozes personalizadas com amostras de √°udio de refer√™ncia</p>
            </div>
        </div>

        <!-- Enhanced Interface Guide -->
        <div class="step-card">
            <div class="step-title">
                <span class="step-number">üìä</span>
                <span>Interface Enhanced com Abas</span>
            </div>
            
            <h4>üì± Navega√ß√£o por Abas:</h4>
            <div class="feature-grid">
                <div class="feature-card">
                    <div class="feature-icon">üí¨</div>
                    <h3>Chat</h3>
                    <p>‚Ä¢ Bot√£o de grava√ß√£o de voz üé§<br>
                    ‚Ä¢ Bot√£o de parar grava√ß√£o ‚èπÔ∏è<br>
                    ‚Ä¢ Switch TTS/Texto üîä<br>
                    ‚Ä¢ Chat em tempo real</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üß†</div>
                    <h3>LLM Config</h3>
                    <p>‚Ä¢ OpenRouter, Gemini<br>
                    ‚Ä¢ Sele√ß√£o de modelos<br>
                    ‚Ä¢ Prompts personalizados<br>
                    ‚Ä¢ Controle de criatividade</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üîä</div>
                    <h3>TTS & Voice</h3>
                    <p>‚Ä¢ Coqui TTS Portugu√™s üáµüáπ<br>
                    ‚Ä¢ Teste de voz üéß<br>
                    ‚Ä¢ Download de √°udio üíæ<br>
                    ‚Ä¢ Clonagem de voz üé≠</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üíæ</div>
                    <h3>Database</h3>
                    <p>‚Ä¢ SQLite integrado<br>
                    ‚Ä¢ Consultas com IA<br>
                    ‚Ä¢ Estat√≠sticas em tempo real<br>
                    ‚Ä¢ Hist√≥rico de conversas</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üì±</div>
                    <h3>WhatsApp</h3>
                    <p>‚Ä¢ Business Token<br>
                    ‚Ä¢ Phone Number ID<br>
                    ‚Ä¢ QR Code setup<br>
                    ‚Ä¢ Teste de conex√£o</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üìä</div>
                    <h3>Monitoring</h3>
                    <p>‚Ä¢ Status dos servi√ßos<br>
                    ‚Ä¢ Links √∫teis<br>
                    ‚Ä¢ Health checks<br>
                    ‚Ä¢ Performance</p>
                </div>
            </div>
            
            <div class="network-info">
                <h4>üîä Como Usar o TTS Enhanced:</h4>
                <ol>
                    <li><strong>Aba TTS & Voice:</strong> Acesse as configura√ß√µes de voz</li>
                    <li><strong>Modelo Coqui:</strong> Selecione "VITS - Portuguese (CV)"</li>
                    <li><strong>Teste de Voz:</strong> Digite texto e clique "Reproduzir Voz"</li>
                    <li><strong>Download:</strong> Baixe o √°udio gerado para teste</li>
                    <li><strong>Clonagem:</strong> Fa√ßa upload de amostra de voz (.wav) e treine</li>
                </ol>
            </div>
        </div>

        <!-- Testing Guide -->
        <div class="step-card">
            <div class="step-title">
                <span class="step-number">6</span>
                <span>Testar a Interface</span>
            </div>
            
            <h4>No Computador:</h4>
            <a href="http://localhost:8001" target="_blank" class="btn">üñ•Ô∏è Abrir Interface</a>
            <a href="http://localhost:8001/docs" target="_blank" class="btn btn-secondary">üìñ API Docs</a>
            
            <h4>Testes a Realizar:</h4>
            <ul>
                <li>üé§ <strong>Grava√ß√£o de Voz:</strong> Clique no microfone e permita acesso</li>
                <li>üí¨ <strong>Chat de Texto:</strong> Digite mensagens na caixa</li>
                <li>üîå <strong>WebSocket:</strong> Verifique status "Conectado"</li>
                <li>üì± <strong>Celular:</strong> Acesse via QR code na mesma WiFi</li>
            </ul>
        </div>

        <!-- Troubleshooting -->
        <div class="troubleshoot">
            <h3>üîß Solu√ß√£o de Problemas</h3>
            
            <h4>‚ùå Erro: "Port already in use" / "Porta j√° em uso"</h4>
            <ul>
                <li><strong>Solu√ß√£o Autom√°tica:</strong> Use <code>start_enhanced_correct.bat</code> (j√° inclui cleanup)</li>
                <li><strong>Solu√ß√£o Manual:</strong> Execute <code>cleanup_ports.bat</code> antes de iniciar</li>
                <li><strong>Verifica√ß√£o:</strong> <code>netstat -ano | findstr ":8001"</code> para ver processos ativos</li>
                <li><strong>Kill Manual:</strong> <code>taskkill /f /pid [PID_NUMBER]</code> para terminar processo espec√≠fico</li>
            </ul>
            
            <h4>‚ùå Erro: "Modelo Whisper n√£o carregando"</h4>
            <ul>
                <li>Aguarde o download (primeira execu√ß√£o pode demorar 5-10 minutos)</li>
                <li>Verifique espa√ßo em disco (modelos Whisper ~150MB + Coqui TTS ~500MB)</li>
                <li>Reinstale: <code>pip install --upgrade openai-whisper faster-whisper</code></li>
                <li>Limpe cache: Apague pasta <code>~/.cache/whisper</code></li>
            </ul>

            <h4>‚ùå Erro: "Connection Refused"</h4>
            <ul>
                <li>Verifique se o servidor est√° rodando (veja logs no terminal)</li>
                <li>Confirme a porta 8001 com <code>netstat -ano | findstr ":8001"</code></li>
                <li>Desative firewall/antiv√≠rus temporariamente</li>
                <li>Teste localhost primeiro: <code>curl http://localhost:8001/health</code></li>
            </ul>

            <h4>‚ùå Erro: "Microfone n√£o funciona"</h4>
            <ul>
                <li>Permita acesso ao microfone no navegador (clique no √≠cone de cadeado)</li>
                <li>Use HTTPS em produ√ß√£o para acesso externo</li>
                <li>Teste em navegador diferente (Chrome recomendado)</li>
                <li>Verifique se microfone funciona em outras aplica√ß√µes</li>
            </ul>
            
            <h4>‚ùå Erro: "Coqui TTS n√£o funciona"</h4>
            <ul>
                <li>Instale manualmente: <code>pip install TTS torch torchaudio</code></li>
                <li>Teste modelo espec√≠fico na aba "TTS & Voice"</li>
                <li>Verifique logs para erros de download de modelos</li>
                <li>Primeira execu√ß√£o baixa modelos automaticamente (~500MB)</li>
            </ul>
            
            <h4>‚ùå Erro: "Virtual Environment"</h4>
            <ul>
                <li>Crie manualmente: <code>python -m venv venv</code></li>
                <li>Ative: <code>venv\Scripts\activate</code> (Windows)</li>
                <li>Instale depend√™ncias: <code>pip install -r requirements.txt</code></li>
                <li>Use <code>start_venv.bat</code> para automatizar</li>
            </ul>

            <h4>üîç Verificar Logs e Status:</h4>
            <div class="code-block">
# Terminal onde o servidor est√° rodando mostra logs em tempo real
# Procure por estas mensagens de sucesso:
# ‚úÖ "Port cleanup completed"
# ‚úÖ "Whisper model loaded successfully"
# ‚úÖ "Coqui TTS initialized"
# ‚úÖ "Enhanced services initialized"
# ‚úÖ "Server running on http://0.0.0.0:8001"

# Health check:
curl http://localhost:8001/health

# Verificar modelos TTS:
curl http://localhost:8001/api/tts/models

# Status dos servi√ßos:
curl http://localhost:8001/api/status
            </div>
            
            <h4>üéÜ Dicas de Performance:</h4>
            <ul>
                <li><strong>GPU:</strong> Se tiver NVIDIA, instale CUDA para acelera√ß√£o</li>
                <li><strong>RAM:</strong> M√≠nimo 4GB, recomendado 8GB+ para todos os modelos</li>
                <li><strong>Disco:</strong> SSD recomendado para carregamento r√°pido de modelos</li>
                <li><strong>Internet:</strong> Primeira execu√ß√£o requer boa conex√£o para downloads</li>
            </ul>
        </div>

        <!-- Mobile Configuration Enhanced -->
        <div class="step-card">
            <div class="step-title">
                <span class="step-number">üì±</span>
                <span>Configura√ß√£o M√≥vel Enhanced</span>
            </div>
            
            <h4>üîç Passo a Passo para Celular:</h4>
            <ol>
                <li><strong>Mesma Rede WiFi:</strong> Conecte o celular na mesma rede do computador</li>
                <li><strong>Gerar QR Code:</strong> Use o bot√£o abaixo para criar QR code de acesso</li>
                <li><strong>Escanear:</strong> Abra a c√¢mera do celular e escaneie o QR code</li>
                <li><strong>Testar Interface:</strong> Navegue pelas abas e teste funcionalidades</li>
                <li><strong>Permiss√µes:</strong> Autorize acesso ao microfone quando solicitado</li>
            </ol>
            
            <div class="network-info">
                <h4>üé§ Testes no Celular:</h4>
                <ul>
                    <li><strong>Aba Chat:</strong> Grave √°udio tocando no microfone üé§</li>
                    <li><strong>Aba TTS:</strong> Digite texto e reproduza voz em portugu√™s üîä</li>
                    <li><strong>Navega√ß√£o:</strong> Teste todas as 6 abas da interface</li>
                    <li><strong>Responsividade:</strong> Interface adapta automaticamente ao celular</li>
                </ul>
            </div>
        </div>

        <!-- WhatsApp Integration Enhanced -->
        <div class="step-card">
            <div class="step-title">
                <span class="step-number">7</span>
                <span>Integra√ß√£o WhatsApp Enhanced</span>
            </div>
            
            <div class="network-info">
                <h4>üì± WhatsApp Business API Enhanced</h4>
                <p>Configure na <strong>Aba WhatsApp</strong> da interface:</p>
                <ol>
                    <li><strong>Business Token:</strong> Cole seu token do WhatsApp Business</li>
                    <li><strong>Phone Number ID:</strong> Insira o ID do n√∫mero (obtido via QR code)</li>
                    <li><strong>Webhook URL:</strong> <code>http://SEU_IP:8001/api/whatsapp/webhook</code></li>
                    <li><strong>Gerar QR Code:</strong> Use o bot√£o na interface para configura√ß√£o</li>
                    <li><strong>Testar Conex√£o:</strong> Clique em "Testar Conex√£o" para validar</li>
                </ol>
                
                <h4>üìä Funcionalidades Integradas:</h4>
                <ul>
                    <li>üé§ <strong>Voz para WhatsApp:</strong> Transcreve √°udios recebidos</li>
                    <li>üîä <strong>Resposta TTS:</strong> Envia √°udio sintetizado em portugu√™s</li>
                    <li>üíæ <strong>Hist√≥rico:</strong> Salva conversas no banco de dados</li>
                    <li>üß† <strong>IA Integrada:</strong> Respostas via OpenRouter/Gemini</li>
                </ul>
            </div>
        </div>

        <!-- Progress Tracking Enhanced -->
        <div class="step-card">
            <div class="step-title">
                <span class="step-number">üìä</span>
                <span>Status do Sistema Enhanced</span>
            </div>
            
            <div>
                <label>Backend FastAPI Enhanced:</label>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 100%;"></div>
                </div>
            </div>
            
            <div>
                <label>Whisper STT (Faster + OpenAI):</label>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 100%;"></div>
                </div>
            </div>
            
            <div>
                <label>Coqui TTS Portugu√™s:</label>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 100%;"></div>
                </div>
            </div>
            
            <div>
                <label>Interface com Abas:</label>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 100%;"></div>
                </div>
            </div>
            
            <div>
                <label>Multi-LLM (OpenRouter/Gemini):</label>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 100%;"></div>
                </div>
            </div>
            
            <div>
                <label>Database com IA:</label>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 100%;"></div>
                </div>
            </div>
            
            <div>
                <label>Clonagem de Voz:</label>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 85%;"></div>
                </div>
            </div>
            
            <div>
                <label>WhatsApp Business Integration:</label>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 90%;"></div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <h3>üéÜ Sistema Enhanced Pronto!</h3>
            <p>WhatsApp Voice Agent V2 Enhanced - Interface com Abas + Coqui TTS + Multi-LLM</p>
            <p>üìä Recursos: 6 Abas | üîä TTS Portugu√™s | üß† Multi-LLM | üíæ Database IA | üé≠ Clonagem Voz</p>
            <p>üìß Suporte: Logs no terminal | üîó Docs: /docs | üìä Health: /health | üìä API: /api/models</p>
        </div>
    </div>

    <script>
        // Copy code functionality
        function copyCode(button) {
            const codeBlock = button.nextElementSibling || button.parentElement;
            const text = codeBlock.textContent.replace('Copiar', '').trim();
            navigator.clipboard.writeText(text).then(() => {
                button.textContent = 'Copiado!';
                setTimeout(() => {
                    button.textContent = 'Copiar';
                }, 2000);
            });
        }

        // Detect local IP
        function detectIP() {
            // This is a simple method, in a real scenario you might need server-side help
            const ipInput = document.getElementById('ipInput');
            
            // Try to get IP from WebRTC (works in most browsers)
            const RTCPeerConnection = window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection;
            
            if (RTCPeerConnection) {
                const pc = new RTCPeerConnection({iceServers: [{urls: 'stun:stun.l.google.com:19302'}]});
                pc.createDataChannel('');
                pc.createOffer().then(pc.setLocalDescription.bind(pc));
                
                pc.onicecandidate = function(event) {
                    if (event.candidate) {
                        const candidate = event.candidate.candidate;
                        const ip = candidate.match(/(\d+\.\d+\.\d+\.\d+)/);
                        if (ip && ip[1] !== '127.0.0.1') {
                            ipInput.value = ip[1];
                            document.getElementById('currentIP').textContent = `üåê IP Detectado: ${ip[1]}`;
                            pc.close();
                        }
                    }
                };
            } else {
                alert('Detec√ß√£o autom√°tica n√£o suportada. Digite o IP manualmente.');
            }
        }

        // Generate QR Code
        function generateQR() {
            const ip = document.getElementById('ipInput').value;
            if (!ip || !ip.match(/^\d+\.\d+\.\d+\.\d+$/)) {
                alert('Por favor, digite um IP v√°lido (ex: 192.168.1.100)');
                return;
            }

            const url = `http://${ip}:8001`;
            
            // Clear previous QR code
            document.getElementById('qrcode').innerHTML = '';
            
            // Generate QR code using qrcode.js
            const qr = qrcode(0, 'M');
            qr.addData(url);
            qr.make();
            
            // Create QR code image
            const qrImage = document.createElement('img');
            qrImage.src = qr.createDataURL(8, 4);
            qrImage.style.maxWidth = '200px';
            qrImage.style.border = '2px solid #4CAF50';
            qrImage.style.borderRadius = '10px';
            
            document.getElementById('qrcode').appendChild(qrImage);
            document.getElementById('qrcode').style.display = 'block';
            
            // Update links
            document.getElementById('mainLink').textContent = url;
            document.getElementById('healthLink').textContent = `${url}/health`;
            document.getElementById('mobileLinks').style.display = 'block';
            
            // Show success message
            const currentIP = document.getElementById('currentIP');
            currentIP.innerHTML = `
                <div style="color: #28a745; font-size: 1.1em;">
                    ‚úÖ QR Code gerado para: <strong>${url}</strong><br>
                    üì± Escaneie com o celular na mesma WiFi
                </div>
            `;
        }

        // Auto-detect IP on page load
        window.onload = function() {
            detectIP();
        };
    </script>
</body>
</html>